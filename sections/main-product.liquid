{%- liquid
  assign current_variant = product.selected_or_first_available_variant
  assign product_form_id = 'product-form-' | append: section.id
  
  # Smart badges
  assign show_bestseller = false
  assign show_new = false
  assign show_sale = false
  
  if section.settings.enable_bestseller_badge
    if product.tags contains 'bestseller' or product.tags contains 'bestselling'
      assign show_bestseller = true
    endif
  endif
  
  if section.settings.enable_new_badge
    if product.tags contains 'new' or product.tags contains 'new-product'
      assign show_new = true
    endif
  endif
  
  if section.settings.enable_sale_badge
    if current_variant.compare_at_price > current_variant.price
      assign show_sale = true
      assign sale_percentage = current_variant.compare_at_price | minus: current_variant.price | times: 100.0 | divided_by: current_variant.compare_at_price | round
    endif
  endif
  
  # Check if we have form blocks
  assign has_variant_picker = false
  assign has_quantity = false
  assign has_buy_buttons = false
  for block in section.blocks
    if block.type == 'variant_picker'
      assign has_variant_picker = true
    elsif block.type == 'quantity_selector'
      assign has_quantity = true
    elsif block.type == 'buy_buttons'
      assign has_buy_buttons = true
    endif
  endfor
  assign needs_form = has_variant_picker or has_quantity or has_buy_buttons
-%}

<div class="product-page py-8 md:py-12 px-4" data-section-id="{{ section.id }}" data-product-id="{{ product.id }}">
  <div class="container mx-auto max-w-7xl">
    <div class="grid md:grid-cols-2 gap-8 md:gap-12">
      
      {% comment %} Product Media Gallery {% endcomment %}
      <div class="product-media">
        <div class="space-y-4">
          {% comment %} Badges {% endcomment %}
          {% if show_bestseller or show_new or show_sale %}
            <div class="product-badges flex gap-2 {% if section.settings.badge_position == 'top-right' %}justify-end{% else %}justify-start{% endif %}">
              {% if show_bestseller %}
                <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-primary text-primary-foreground">
                  Bestseller
                </span>
              {% endif %}
              {% if show_new %}
                <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-green-600 text-white">
                  New
                </span>
              {% endif %}
              {% if show_sale %}
                <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-red-600 text-white">
                  Sale {{ sale_percentage }}% OFF
                </span>
              {% endif %}
            </div>
          {% endif %}

          {% comment %} Main Media Display {% endcomment %}
          <div class="product-media-main relative aspect-square rounded-lg overflow-hidden bg-card border border-border group" data-media-container>
            {% if product.featured_media %}
              {% if product.featured_media.media_type == 'video' %}
                <div class="relative w-full h-full" data-video-container>
                  {{ product.featured_media | video_tag: image_size: '1200x1200', autoplay: false, loop: false, controls: true, class: 'w-full h-full object-cover' }}
                </div>
              {% elsif product.featured_media.media_type == 'external_video' %}
                <div class="relative w-full h-full" data-external-video-container data-video-id="{{ product.featured_media.external_id }}" data-video-type="{{ product.featured_media.host }}">
                  <div class="aspect-square bg-black flex items-center justify-center">
                    <img src="{{ product.featured_media.preview_image | image_url: width: 1200 }}" alt="{{ product.title }}" class="w-full h-full object-cover">
                    <button type="button" class="absolute inset-0 flex items-center justify-center bg-black/50 hover:bg-black/70 transition-colors" data-play-video aria-label="Play video">
                      <svg class="w-16 h-16 text-white" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M8 5v14l11-7z"/>
                      </svg>
                    </button>
                  </div>
                </div>
              {% else %}
                <img
                  id="product-main-image-{{ section.id }}"
                  src="{{ product.featured_media | image_url: width: 1200 }}"
                  alt="{{ product.featured_media.alt | default: product.title | escape }}"
                  class="w-full h-full object-cover"
                  loading="eager"
                  width="{{ product.featured_media.width }}"
                  height="{{ product.featured_media.height }}"
                  data-main-image
                >
                {% if section.settings.enable_image_zoom %}
                  <button
                    type="button"
                    class="absolute top-4 right-4 w-10 h-10 flex items-center justify-center bg-background/90 backdrop-blur-sm rounded-full hover:bg-background transition-all opacity-0 group-hover:opacity-100"
                    aria-label="Zoom image"
                    data-zoom-trigger
                  >
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v6m3-3H7"></path>
                    </svg>
                  </button>
                {% endif %}
              {% endif %}
            {% else %}
              <div class="w-full h-full flex items-center justify-center">
                <span class="text-muted-foreground">{{ 'products.product.no_image' | t }}</span>
              </div>
            {% endif %}
          </div>

          {% comment %} Thumbnail Gallery {% endcomment %}
          {% assign media_count = product.media.size %}
          {% if media_count > 1 %}
            {% assign max_thumbnails = section.settings.thumbnail_count | default: 8 %}
            {% assign thumbnails_to_show = media_count %}
            {% if thumbnails_to_show > max_thumbnails %}
              {% assign thumbnails_to_show = max_thumbnails %}
            {% endif %}
            
            <div class="product-media-thumbnails flex gap-2 overflow-x-auto pb-2" data-thumbnail-gallery>
              {% for media in product.media limit: thumbnails_to_show %}
                <button
                  type="button"
                  class="flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 transition-colors {% if forloop.first %}border-primary{% else %}border-transparent hover:border-primary/50{% endif %}"
                  data-media-thumbnail
                  data-media-id="{{ media.id }}"
                  data-media-index="{{ forloop.index0 }}"
                  data-media-type="{{ media.media_type }}"
                  aria-label="View {{ media.media_type }} {{ forloop.index }}"
                >
                  {% if media.media_type == 'video' %}
                    <div class="relative w-full h-full bg-muted flex items-center justify-center">
                      <img src="{{ media.preview_image | image_url: width: 100 }}" alt="{{ media.alt | default: product.title }}" class="w-full h-full object-cover">
                      <div class="absolute inset-0 flex items-center justify-center bg-black/30">
                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M8 5v14l11-7z"/>
                        </svg>
                      </div>
                    </div>
                  {% elsif media.media_type == 'external_video' %}
                    <div class="relative w-full h-full bg-muted flex items-center justify-center">
                      <img src="{{ media.preview_image | image_url: width: 100 }}" alt="{{ media.alt | default: product.title }}" class="w-full h-full object-cover">
                      <div class="absolute inset-0 flex items-center justify-center bg-black/30">
                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M8 5v14l11-7z"/>
                        </svg>
                      </div>
                    </div>
                  {% else %}
                    {{ media | image_url: width: 100 | image_tag: class: 'w-full h-full object-cover', loading: 'lazy', alt: media.alt | default: product.title }}
                  {% endif %}
                </button>
              {% endfor %}
            </div>
          {% endif %}
        </div>
      </div>

      {% comment %} Product Information (Block-Based) {% endcomment %}
      <div class="product-info space-y-6">
        {% if needs_form %}
          {% form 'product', product, id: product_form_id, class: 'product-form', novalidate: 'novalidate', data-product-form: '' %}
            <input type="hidden" name="id" value="{{ current_variant.id }}" data-variant-id>
        {% endif %}
        
        {% for block in section.blocks %}
          {% case block.type %}
            {% when 'title' %}
              <div {{ block.shopify_attributes }}>
                <h1 class="text-3xl md:text-4xl font-bold mb-2">{{ product.title }}</h1>
                {% if block.settings.show_vendor and product.vendor != blank %}
                  <p class="text-muted-foreground text-sm mb-2">{{ product.vendor }}</p>
                {% endif %}
                {% if block.settings.show_ratings %}
                  <div class="flex items-center gap-2 mt-2">
                    <div class="flex items-center">
                      {% assign rating = block.settings.rating | default: 5 %}
                      {% for i in (1..5) %}
                        {% if i <= rating %}
                          <svg class="w-5 h-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                          </svg>
                        {% else %}
                          <svg class="w-5 h-5 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                          </svg>
                        {% endif %}
                      {% endfor %}
                    </div>
                    {% if block.settings.rating_count %}
                      <span class="text-sm text-muted-foreground">({{ block.settings.rating_count }})</span>
                    {% endif %}
                  </div>
                {% endif %}
              </div>

            {% when 'price' %}
              <div class="product-price" {{ block.shopify_attributes }}>
                <div class="flex items-baseline gap-3 mb-2">
                  <span class="text-3xl font-bold" id="product-price-{{ section.id }}" data-price>
                    {{ current_variant.price | money }}
                  </span>
                  {% if current_variant.compare_at_price > current_variant.price %}
                    <span class="text-lg text-muted-foreground line-through" id="product-compare-price-{{ section.id }}" data-compare-price>
                      {{ current_variant.compare_at_price | money }}
                    </span>
                    <span class="text-sm text-primary font-semibold" data-sale-badge>
                      {{ sale_percentage }}% {{ 'products.product.off' | t }}
                    </span>
                  {% endif %}
                </div>
                {% if block.settings.show_tax_text %}
                  <p class="text-sm text-muted-foreground">{{ 'products.product.tax_included' | t }}</p>
                {% endif %}
                {% if block.settings.show_subscription_info %}
                  <div class="mt-2 p-3 bg-card border border-border rounded-md">
                    <p class="text-sm font-medium mb-1">{{ block.settings.subscription_label | default: 'Subscribe & Save' }}</p>
                    <p class="text-sm text-muted-foreground">{{ block.settings.subscription_text | default: 'Save 10% with a subscription' }}</p>
                  </div>
                {% endif %}
              </div>

            {% when 'variant_picker' %}
              <div class="product-variants" {{ block.shopify_attributes }}>
                {% unless product.has_only_default_variant %}
                  {% if block.settings.variant_style == 'buttons' and block.settings.show_color_swatches %}
                    {% comment %} Button style for color variants {% endcomment %}
                    <div class="space-y-4">
                      {% for option in product.options_with_values %}
                        <div>
                          <label class="block text-sm font-medium mb-2">
                            {{ option.name }}
                          </label>
                          {% if option.name == 'Color' or option.name == 'Colour' %}
                            <div class="flex flex-wrap gap-2">
                              {% for value in option.values %}
                                <button
                                  type="button"
                                  class="variant-option-button w-10 h-10 rounded-full border-2 transition-colors {% if option.selected_value == value %}border-primary ring-2 ring-primary ring-offset-2{% else %}border-border hover:border-primary/50{% endif %}"
                                  data-option-position="{{ option.position }}"
                                  data-option-value="{{ value | escape }}"
                                  aria-label="{{ value }}"
                                  title="{{ value }}"
                                >
                                  <span class="sr-only">{{ value }}</span>
                                </button>
                              {% endfor %}
                            </div>
                            <select
                              name="options[{{ option.name | escape }}]"
                              class="hidden variant-select"
                              data-option-position="{{ option.position }}"
                              {% if needs_form %}form="{{ product_form_id }}"{% endif %}
                            >
                              {% for value in option.values %}
                                <option value="{{ value | escape }}" {% if option.selected_value == value %}selected{% endif %}>{{ value }}</option>
                              {% endfor %}
                            </select>
                          {% else %}
                            <select
                              name="options[{{ option.name | escape }}]"
                              class="variant-select w-full px-4 py-2 border border-input bg-background rounded-md text-foreground focus:outline-none focus:ring-2 focus:ring-ring"
                              data-option-position="{{ option.position }}"
                              {% if needs_form %}form="{{ product_form_id }}"{% endif %}
                            >
                              {% for value in option.values %}
                                <option value="{{ value | escape }}" {% if option.selected_value == value %}selected{% endif %}>{{ value }}</option>
                              {% endfor %}
                            </select>
                          {% endif %}
                        </div>
                      {% endfor %}
                    </div>
                  {% else %}
                    {% comment %} Dropdown style (default) {% endcomment %}
                    <div class="space-y-4">
                      {% for option in product.options_with_values %}
                        <div>
                          <label for="option-{{ section.id }}-{{ forloop.index0 }}" class="block text-sm font-medium mb-2">
                            {{ option.name }}
                          </label>
                          <select
                            id="option-{{ section.id }}-{{ forloop.index0 }}"
                            name="options[{{ option.name | escape }}]"
                            class="variant-select w-full px-4 py-2 border border-input bg-background rounded-md text-foreground focus:outline-none focus:ring-2 focus:ring-ring"
                            data-option-position="{{ option.position }}"
                            {% if needs_form %}form="{{ product_form_id }}"{% endif %}
                          >
                            {% for value in option.values %}
                              <option value="{{ value | escape }}" {% if option.selected_value == value %}selected{% endif %}>{{ value }}</option>
                            {% endfor %}
                          </select>
                        </div>
                      {% endfor %}
                    </div>
                  {% endif %}
                {% endunless %}
              </div>

            {% when 'quantity_selector' %}
              <div {{ block.shopify_attributes }}>
                <label for="quantity-{{ section.id }}" class="block text-sm font-medium mb-2">
                  {{ 'products.product.quantity.label' | t }}
                </label>
                <div class="flex items-center gap-2 w-32">
                  <button
                    type="button"
                    class="w-10 h-10 flex items-center justify-center border border-input rounded-md hover:bg-accent transition-colors"
                    data-quantity-decrease
                    aria-label="{{ 'products.product.quantity.decrease' | t }}"
                  >
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path>
                    </svg>
                  </button>
                  <input
                    type="number"
                    id="quantity-{{ section.id }}"
                    name="quantity"
                    value="1"
                    min="1"
                    class="w-full px-3 py-2 border border-input bg-background rounded-md text-center focus:outline-none focus:ring-2 focus:ring-ring"
                    data-quantity-input
                    {% if needs_form %}form="{{ product_form_id }}"{% endif %}
                  >
                  <button
                    type="button"
                    class="w-10 h-10 flex items-center justify-center border border-input rounded-md hover:bg-accent transition-colors"
                    data-quantity-increase
                    aria-label="{{ 'products.product.quantity.increase' | t }}"
                  >
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                    </svg>
                  </button>
                </div>
              </div>

            {% when 'buy_buttons' %}
              <div class="product-buy-buttons" {{ block.shopify_attributes }}>
                {% comment %} Stock Messaging {% endcomment %}
                {% if block.settings.show_stock_message %}
                  <div class="product-stock mb-4" data-stock-message>
                    {% if current_variant.inventory_quantity > 0 %}
                      {% if current_variant.inventory_quantity <= block.settings.low_stock_threshold %}
                        <p class="text-sm text-orange-600 font-medium">
                          {{ 'products.product.low_stock' | t: quantity: current_variant.inventory_quantity }}
                        </p>
                      {% else %}
                        <p class="text-sm text-green-600 font-medium">
                          {{ 'products.product.in_stock' | t }} - {{ block.settings.in_stock_text | default: 'Ready to ship' }}
                        </p>
                      {% endif %}
                    {% else %}
                      {% if current_variant.inventory_policy == 'continue' %}
                        <p class="text-sm text-muted-foreground">
                          {{ 'products.product.backorder' | t }}
                        </p>
                      {% else %}
                        <p class="text-sm text-destructive font-medium">
                          {{ 'products.product.sold_out' | t }}
                        </p>
                      {% endif %}
                    {% endif %}
                  </div>
                {% endif %}

                {% comment %} Add to Cart Button {% endcomment %}
                <button
                  type="submit"
                  name="add"
                  class="w-full inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-12 px-8 text-base mb-3"
                  id="add-to-cart-{{ section.id }}"
                  data-add-to-cart
                  {% if needs_form %}form="{{ product_form_id }}"{% endif %}
                  {% unless current_variant.available %}disabled{% endunless %}
                >
                  <span data-add-to-cart-text>
                    {% if current_variant.available %}
                      {{ 'products.product.add_to_cart' | t }}
                    {% else %}
                      {{ 'products.product.sold_out' | t }}
                    {% endif %}
                  </span>
                </button>

                {% comment %} Dynamic Checkout Buttons {% endcomment %}
                {% if block.settings.show_dynamic_checkout and needs_form %}
                  <div class="dynamic-checkout-buttons mt-3" data-dynamic-checkout>
                    {{ form | payment_button }}
                  </div>
                {% endif %}
              </div>

            {% when 'trust_badges' %}
              <div class="product-trust-badges py-4 border-y border-border" {{ block.shopify_attributes }}>
                {% if block.settings.show_trust_badges %}
                  <div class="flex flex-wrap gap-4">
                    {% if block.settings.trust_badge_1_text != blank %}
                      <div class="flex items-center gap-2 text-sm">
                        {% if block.settings.trust_badge_1_icon != blank %}
                          {{ block.settings.trust_badge_1_icon | image_url: width: 24 | image_tag: class: 'w-6 h-6', loading: 'lazy' }}
                        {% endif %}
                        <span>{{ block.settings.trust_badge_1_text }}</span>
                      </div>
                    {% endif %}
                    {% if block.settings.trust_badge_2_text != blank %}
                      <div class="flex items-center gap-2 text-sm">
                        {% if block.settings.trust_badge_2_icon != blank %}
                          {{ block.settings.trust_badge_2_icon | image_url: width: 24 | image_tag: class: 'w-6 h-6', loading: 'lazy' }}
                        {% endif %}
                        <span>{{ block.settings.trust_badge_2_text }}</span>
                      </div>
                    {% endif %}
                    {% if block.settings.trust_badge_3_text != blank %}
                      <div class="flex items-center gap-2 text-sm">
                        {% if block.settings.trust_badge_3_icon != blank %}
                          {{ block.settings.trust_badge_3_icon | image_url: width: 24 | image_tag: class: 'w-6 h-6', loading: 'lazy' }}
                        {% endif %}
                        <span>{{ block.settings.trust_badge_3_text }}</span>
                      </div>
                    {% endif %}
                  </div>
                {% endif %}
              </div>

            {% when 'description' %}
              <div class="product-description" {{ block.shopify_attributes }}>
                {% if block.settings.show_description and product.description != blank %}
                  <div class="prose prose-sm max-w-none text-muted-foreground">
                    {{ product.description | strip_html | truncate: block.settings.description_length }}
                  </div>
                  {% if block.settings.show_read_more %}
                    <button type="button" class="text-primary font-semibold text-sm mt-2 hover:underline" data-read-more>
                      Read more
                    </button>
                  {% endif %}
                {% endif %}
              </div>

            {% when 'collapsible_tab' %}
              <div class="product-collapsible-tab border border-border rounded-lg" {{ block.shopify_attributes }}>
                <button
                  type="button"
                  class="w-full px-4 py-3 flex items-center justify-between text-left hover:bg-accent transition-colors"
                  data-tab-toggle
                  aria-expanded="false"
                >
                  <span class="font-semibold">{{ block.settings.tab_title }}</span>
                  <svg class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                  </svg>
                </button>
                <div class="hidden px-4 pb-4" data-tab-content>
                  <div class="prose prose-sm max-w-none text-muted-foreground pt-2">
                    {{ block.settings.tab_content }}
                  </div>
                </div>
              </div>

            {% when 'share_buttons' %}
              <div class="product-share-buttons" {{ block.shopify_attributes }}>
                {% if block.settings.show_share_buttons %}
                  <p class="text-sm font-medium mb-2">{{ block.settings.share_label | default: 'Share' }}</p>
                  <div class="flex gap-2 flex-wrap">
                    {% if block.settings.show_facebook %}
                      <a
                        href="https://www.facebook.com/sharer/sharer.php?u={{ shop.url | append: product.url | url_param_escape }}"
                        target="_blank"
                        rel="noopener noreferrer"
                        class="w-10 h-10 flex items-center justify-center border border-input rounded-md hover:bg-accent transition-colors"
                        aria-label="Share on Facebook"
                      >
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                        </svg>
                      </a>
                    {% endif %}
                    {% if block.settings.show_twitter %}
                      <a
                        href="https://twitter.com/intent/tweet?url={{ shop.url | append: product.url | url_param_escape }}&text={{ product.title | url_param_escape }}"
                        target="_blank"
                        rel="noopener noreferrer"
                        class="w-10 h-10 flex items-center justify-center border border-input rounded-md hover:bg-accent transition-colors"
                        aria-label="Share on Twitter"
                      >
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
                        </svg>
                      </a>
                    {% endif %}
                    {% if block.settings.show_pinterest %}
                      <a
                        href="https://pinterest.com/pin/create/button/?url={{ shop.url | append: product.url | url_param_escape }}&media={{ product.featured_media | image_url: width: 1200 | url_param_escape }}&description={{ product.title | url_param_escape }}"
                        target="_blank"
                        rel="noopener noreferrer"
                        class="w-10 h-10 flex items-center justify-center border border-input rounded-md hover:bg-accent transition-colors"
                        aria-label="Share on Pinterest"
                      >
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.402.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.357-.629-2.748-1.378l-.748 2.853c-.271 1.043-1.002 2.35-1.492 3.146C9.57 23.812 10.763 24.009 12.017 24.009c6.624 0 11.99-5.367 11.99-11.988C24.007 5.367 18.641.001 12.017.001z"/>
                        </svg>
                      </a>
                    {% endif %}
                    {% if block.settings.show_copy_link %}
                      <button
                        type="button"
                        class="w-10 h-10 flex items-center justify-center border border-input rounded-md hover:bg-accent transition-colors copy-link-button"
                        aria-label="Copy link"
                        data-product-url="{{ shop.url | append: product.url }}"
                      >
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                        </svg>
                      </button>
                    {% endif %}
                  </div>
                {% endif %}
              </div>

            {% when '@app' %}
              {% render block %}
          {% endcase %}
        {% endfor %}
        
        {% if needs_form %}
          {% endform %}
        {% endif %}
      </div>
    </div>

    {% comment %} Full Product Description {% endcomment %}
    {% if section.settings.show_full_description and product.description != blank %}
      <div class="product-description-full mt-12 pt-12 border-t border-border">
        <h2 class="text-2xl font-bold mb-6">{{ 'products.product.description' | t }}</h2>
        <div class="prose prose-lg max-w-none">
          {{ product.description }}
        </div>
      </div>
    {% endif %}
  </div>
</div>

<script>
  (function() {
    const sectionId = {{ section.id | json }};
    const productForm = document.getElementById('product-form-' + sectionId);
    if (!productForm) return;

    const variantSelects = productForm.querySelectorAll('.variant-select');
    const variantButtons = document.querySelectorAll('.variant-option-button');
    const variantIdInput = productForm.querySelector('[data-variant-id]');
    const priceElement = document.querySelector('[data-price]');
    const comparePriceElement = document.querySelector('[data-compare-price]');
    const saleBadgeElement = document.querySelector('[data-sale-badge]');
    const addToCartButton = document.getElementById('add-to-cart-' + sectionId);
    const addToCartText = addToCartButton?.querySelector('[data-add-to-cart-text]');
    const stockMessage = document.querySelector('[data-stock-message]');

    const variants = [
      {% for variant in product.variants %}
        {
          id: {{ variant.id }},
          price: {{ variant.price }},
          priceFormatted: {{ variant.price | money | json }},
          compareAtPrice: {{ variant.compare_at_price | default: 0 }},
          compareAtPriceFormatted: {% if variant.compare_at_price %}{{ variant.compare_at_price | money | json }}{% else %}null{% endif %},
          available: {{ variant.available | json }},
          inventoryQuantity: {{ variant.inventory_quantity | default: 0 }},
          inventoryPolicy: {{ variant.inventory_policy | json }},
          option1: {{ variant.option1 | json }},
          option2: {{ variant.option2 | json }},
          option3: {{ variant.option3 | json }},
          url: {{ product.url | append: '?variant=' | append: variant.id | json }}
        }{% unless forloop.last %},{% endunless %}
      {% endfor %}
    ];

    const productMedia = [
      {% for media in product.media %}
        {
          id: {{ media.id }},
          type: {{ media.media_type | json }},
          src: {% if media.media_type == 'image' %}{{ media | image_url: width: 1200 | json }}{% else %}null{% endif %},
          previewSrc: {{ media.preview_image | image_url: width: 1200 | json }},
          alt: {{ media.alt | default: product.title | json }},
          externalId: {% if media.external_id %}{{ media.external_id | json }}{% else %}null{% endif %},
          host: {% if media.host %}{{ media.host | json }}{% else %}null{% endif %},
          variantIds: [{% for variant in product.variants %}{% if variant.featured_media == media %}{{ variant.id }}{% unless forloop.last %},{% endunless %}{% endif %}{% endfor %}]
        }{% unless forloop.last %},{% endunless %}
      {% endfor %}
    ];

    function updateVariant() {
      const selectedOptions = {};
      variantSelects.forEach(select => {
        const position = select.dataset.optionPosition;
        selectedOptions['option' + position] = select.value;
      });

      const selectedVariant = variants.find(variant => {
        return (!selectedOptions.option1 || variant.option1 === selectedOptions.option1) &&
               (!selectedOptions.option2 || variant.option2 === selectedOptions.option2) &&
               (!selectedOptions.option3 || variant.option3 === selectedOptions.option3);
      });

      if (selectedVariant) {
        variantIdInput.value = selectedVariant.id;

        // Update price
        if (priceElement) {
          priceElement.textContent = selectedVariant.priceFormatted;
        }

        // Update compare at price
        if (comparePriceElement) {
          if (selectedVariant.compareAtPrice > selectedVariant.price) {
            comparePriceElement.textContent = selectedVariant.compareAtPriceFormatted;
            comparePriceElement.classList.remove('hidden');
            const salePercentage = Math.round((selectedVariant.compareAtPrice - selectedVariant.price) / selectedVariant.compareAtPrice * 100);
            if (saleBadgeElement) {
              saleBadgeElement.textContent = salePercentage + '% ' + {{ 'products.product.off' | t | json }};
              saleBadgeElement.classList.remove('hidden');
            }
          } else {
            comparePriceElement.classList.add('hidden');
            if (saleBadgeElement) {
              saleBadgeElement.classList.add('hidden');
            }
          }
        }

        // Update availability
        if (addToCartButton) {
          addToCartButton.disabled = !selectedVariant.available;
        }
        if (addToCartText) {
          addToCartText.textContent = selectedVariant.available
            ? {{ 'products.product.add_to_cart' | t | json }}
            : {{ 'products.product.sold_out' | t | json }};
        }

        // Update stock message
        if (stockMessage) {
          const lowStockThreshold = {{ section.settings.low_stock_threshold | default: 10 }};
          const inStockText = {{ 'products.product.in_stock' | t | json }};
          const lowStockTextTemplate = {{ 'products.product.low_stock' | t: quantity: '[quantity]' | json }};
          const backorderText = {{ 'products.product.backorder' | t | json }};
          const soldOutText = {{ 'products.product.sold_out' | t | json }};
          const inStockCustomText = {{ section.settings.in_stock_text | default: 'Ready to ship' | json }};
          
          if (selectedVariant.inventoryQuantity > 0) {
            if (selectedVariant.inventoryQuantity <= lowStockThreshold) {
              const lowStockText = lowStockTextTemplate.replace('[quantity]', selectedVariant.inventoryQuantity);
              stockMessage.innerHTML = '<p class="text-sm text-orange-600 font-medium">' + lowStockText + '</p>';
            } else {
              stockMessage.innerHTML = '<p class="text-sm text-green-600 font-medium">' + inStockText + ' - ' + inStockCustomText + '</p>';
            }
          } else {
            if (selectedVariant.inventoryPolicy === 'continue') {
              stockMessage.innerHTML = '<p class="text-sm text-muted-foreground">' + backorderText + '</p>';
            } else {
              stockMessage.innerHTML = '<p class="text-sm text-destructive font-medium">' + soldOutText + '</p>';
            }
          }
        }

        // Update URL
        if (selectedVariant.url && window.history && window.history.replaceState) {
          window.history.replaceState({}, '', selectedVariant.url);
        }

        // Update media if variant has specific media
        const variantMedia = productMedia.find(media => 
          media.variantIds.includes(selectedVariant.id)
        );
        if (variantMedia) {
          updateMainMedia(variantMedia);
        }
      }
    }

    function updateMainMedia(media) {
      const mediaContainer = document.querySelector('[data-media-container]');
      if (!mediaContainer) return;

      if (media.type === 'image' && media.src) {
        mediaContainer.innerHTML = `
          <img
            id="product-main-image-${sectionId}"
            src="${media.src}"
            alt="${media.alt}"
            class="w-full h-full object-cover"
            loading="lazy"
            data-main-image
          >
        `;
      } else if (media.type === 'video') {
        mediaContainer.innerHTML = `
          <div class="relative w-full h-full" data-video-container>
            <video class="w-full h-full object-cover" controls>
              <source src="${media.src}" type="video/mp4">
            </video>
          </div>
        `;
      } else if (media.type === 'external_video') {
        const videoId = media.externalId;
        const host = media.host;
        let embedUrl = '';
        
        if (host === 'youtube') {
          embedUrl = `https://www.youtube.com/embed/${videoId}`;
        } else if (host === 'vimeo') {
          embedUrl = `https://player.vimeo.com/video/${videoId}`;
        }
        
        if (embedUrl) {
          mediaContainer.innerHTML = `
            <div class="relative w-full h-full" data-external-video-container>
              <div class="aspect-square bg-black flex items-center justify-center">
                <img src="${media.previewSrc}" alt="${media.alt}" class="w-full h-full object-cover">
                <button type="button" class="absolute inset-0 flex items-center justify-center bg-black/50 hover:bg-black/70 transition-colors" data-play-video aria-label="Play video">
                  <svg class="w-16 h-16 text-white" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M8 5v14l11-7z"/>
                  </svg>
                </button>
                <iframe class="hidden w-full h-full" src="${embedUrl}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen data-video-iframe></iframe>
              </div>
            </div>
          `;
          
          const playButton = mediaContainer.querySelector('[data-play-video]');
          const videoIframe = mediaContainer.querySelector('[data-video-iframe]');
          if (playButton && videoIframe) {
            playButton.addEventListener('click', () => {
              playButton.classList.add('hidden');
              videoIframe.classList.remove('hidden');
              videoIframe.src = embedUrl + (host === 'youtube' ? '?autoplay=1' : '?autoplay=1');
            });
          }
        }
      }
    }

    // Variant select change
    variantSelects.forEach(select => {
      select.addEventListener('change', updateVariant);
    });

    // Variant button click (for color swatches)
    variantButtons.forEach(button => {
      button.addEventListener('click', function() {
        const position = this.dataset.optionPosition;
        const value = this.dataset.optionValue;
        const select = productForm.querySelector(`.variant-select[data-option-position="${position}"]`);
        if (select) {
          select.value = value;
          select.dispatchEvent(new Event('change'));
        }
        
        // Update button states
        variantButtons.forEach(btn => {
          if (btn.dataset.optionPosition === position) {
            btn.classList.remove('border-primary', 'ring-2', 'ring-primary', 'ring-offset-2');
            btn.classList.add('border-border');
          }
        });
        this.classList.remove('border-border');
        this.classList.add('border-primary', 'ring-2', 'ring-primary', 'ring-offset-2');
      });
    });

    // Quantity controls
    const quantityInput = productForm.querySelector('[data-quantity-input]');
    const quantityDecrease = productForm.querySelector('[data-quantity-decrease]');
    const quantityIncrease = productForm.querySelector('[data-quantity-increase]');

    if (quantityDecrease) {
      quantityDecrease.addEventListener('click', () => {
        const currentValue = parseInt(quantityInput.value) || 1;
        if (currentValue > 1) {
          quantityInput.value = currentValue - 1;
        }
      });
    }

    if (quantityIncrease) {
      quantityIncrease.addEventListener('click', () => {
        const currentValue = parseInt(quantityInput.value) || 1;
        quantityInput.value = currentValue + 1;
      });
    }

    // Media thumbnail click
    const mediaThumbnails = document.querySelectorAll('[data-media-thumbnail]');
    const mainMediaContainer = document.querySelector('[data-media-container]');

    mediaThumbnails.forEach(thumbnail => {
      thumbnail.addEventListener('click', function() {
        const mediaIndex = parseInt(this.dataset.mediaIndex);
        const media = productMedia[mediaIndex];
        
        if (media) {
          updateMainMedia(media);
          
          // Update active thumbnail
          mediaThumbnails.forEach(thumb => {
            thumb.classList.remove('border-primary');
            thumb.classList.add('border-transparent');
          });
          this.classList.remove('border-transparent');
          this.classList.add('border-primary');
        }
      });
    });

    // Collapsible tabs
    const tabToggles = document.querySelectorAll('[data-tab-toggle]');
    tabToggles.forEach(toggle => {
      toggle.addEventListener('click', function() {
        const content = this.nextElementSibling;
        const isExpanded = this.getAttribute('aria-expanded') === 'true';
        
        this.setAttribute('aria-expanded', !isExpanded);
        content.classList.toggle('hidden');
        
        const icon = this.querySelector('svg');
        if (icon) {
          icon.classList.toggle('rotate-180');
        }
      });
    });

    // External video play buttons
    document.addEventListener('click', function(e) {
      if (e.target.closest('[data-play-video]')) {
        const container = e.target.closest('[data-external-video-container]');
        const playButton = container.querySelector('[data-play-video]');
        const videoIframe = container.querySelector('[data-video-iframe]');
        const videoId = container.dataset.videoId;
        const videoType = container.dataset.videoType;
        
        if (playButton && videoIframe) {
          let embedUrl = '';
          if (videoType === 'youtube') {
            embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
          } else if (videoType === 'vimeo') {
            embedUrl = `https://player.vimeo.com/video/${videoId}?autoplay=1`;
          }
          
          if (embedUrl) {
            playButton.classList.add('hidden');
            videoIframe.classList.remove('hidden');
            videoIframe.src = embedUrl;
          }
        }
      }
    });

    // Copy link button
    const copyLinkButtons = document.querySelectorAll('.copy-link-button');
    copyLinkButtons.forEach(button => {
      button.addEventListener('click', function() {
        const url = this.dataset.productUrl;
        navigator.clipboard.writeText(url).then(() => {
          const originalHTML = this.innerHTML;
          this.innerHTML = '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>';
          setTimeout(() => {
            this.innerHTML = originalHTML;
          }, 2000);
        });
      });
    });

    // Form submission handler for AJAX
    if (productForm) {
      productForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        if (!window.CartDrawer) {
          this.submit();
          return;
        }

        const formData = new FormData(this);
        const cartDrawer = new window.CartDrawer();
        
        try {
          await cartDrawer.addToCart(formData);
        } catch (error) {
          console.error('Error adding to cart:', error);
        }
      });
    }
  })();
</script>

{% schema %}
{
  "name": "Main Product",
  "tag": "section",
  "class": "section-main-product",
  "enabled_on": {
    "templates": ["product"]
  },
  "settings": [
    {
      "type": "header",
      "content": "Media"
    },
    {
      "type": "checkbox",
      "id": "enable_video_support",
      "label": "Enable video support",
      "default": true
    },
    {
      "type": "range",
      "id": "thumbnail_count",
      "label": "Maximum thumbnails to show",
      "min": 4,
      "max": 12,
      "step": 1,
      "default": 8
    },
    {
      "type": "checkbox",
      "id": "enable_image_zoom",
      "label": "Enable image zoom",
      "default": true
    },
    {
      "type": "header",
      "content": "Badges"
    },
    {
      "type": "select",
      "id": "badge_position",
      "label": "Badge position",
      "options": [
        {
          "value": "top-left",
          "label": "Top left"
        },
        {
          "value": "top-right",
          "label": "Top right"
        }
      ],
      "default": "top-left"
    },
    {
      "type": "checkbox",
      "id": "enable_bestseller_badge",
      "label": "Show bestseller badge",
      "default": true,
      "info": "Shows when product is tagged 'bestseller' or 'bestselling'"
    },
    {
      "type": "checkbox",
      "id": "enable_new_badge",
      "label": "Show new badge",
      "default": true,
      "info": "Shows when product is tagged 'new' or 'new-product'"
    },
    {
      "type": "checkbox",
      "id": "enable_sale_badge",
      "label": "Show sale badge",
      "default": true,
      "info": "Shows when product has compare_at_price"
    },
    {
      "type": "header",
      "content": "Description"
    },
    {
      "type": "checkbox",
      "id": "show_full_description",
      "label": "Show full description below",
      "default": true
    },
    {
      "type": "header",
      "content": "Stock Messaging"
    },
    {
      "type": "range",
      "id": "low_stock_threshold",
      "label": "Low stock threshold",
      "min": 1,
      "max": 20,
      "step": 1,
      "default": 10
    },
    {
      "type": "text",
      "id": "in_stock_text",
      "label": "In stock text",
      "default": "Ready to ship"
    }
  ],
  "blocks": [
    {
      "type": "title",
      "name": "Title",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_vendor",
          "label": "Show vendor",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "show_ratings",
          "label": "Show ratings",
          "default": false
        },
        {
          "type": "range",
          "id": "rating",
          "label": "Rating",
          "min": 1,
          "max": 5,
          "step": 1,
          "default": 5
        },
        {
          "type": "text",
          "id": "rating_count",
          "label": "Rating count",
          "default": "127",
          "info": "Number of reviews"
        }
      ]
    },
    {
      "type": "price",
      "name": "Price",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_tax_text",
          "label": "Show tax text",
          "default": false
        },
        {
          "type": "checkbox",
          "id": "show_subscription_info",
          "label": "Show subscription info",
          "default": false
        },
        {
          "type": "text",
          "id": "subscription_label",
          "label": "Subscription label",
          "default": "Subscribe & Save"
        },
        {
          "type": "text",
          "id": "subscription_text",
          "label": "Subscription text",
          "default": "Save 10% with a subscription"
        }
      ]
    },
    {
      "type": "variant_picker",
      "name": "Variant Picker",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "variant_style",
          "label": "Variant style",
          "options": [
            {
              "value": "dropdown",
              "label": "Dropdown"
            },
            {
              "value": "buttons",
              "label": "Buttons"
            }
          ],
          "default": "dropdown"
        },
        {
          "type": "checkbox",
          "id": "show_color_swatches",
          "label": "Show color swatches",
          "default": true,
          "info": "Only applies when variant style is 'buttons'"
        }
      ]
    },
    {
      "type": "quantity_selector",
      "name": "Quantity Selector",
      "limit": 1
    },
    {
      "type": "buy_buttons",
      "name": "Buy Buttons",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_dynamic_checkout",
          "label": "Show dynamic checkout buttons",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "show_stock_message",
          "label": "Show stock message",
          "default": true
        },
        {
          "type": "range",
          "id": "low_stock_threshold",
          "label": "Low stock threshold",
          "min": 1,
          "max": 20,
          "step": 1,
          "default": 10
        },
        {
          "type": "text",
          "id": "in_stock_text",
          "label": "In stock text",
          "default": "Ready to ship"
        }
      ]
    },
    {
      "type": "trust_badges",
      "name": "Trust Badges",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_trust_badges",
          "label": "Show trust badges",
          "default": true
        },
        {
          "type": "image_picker",
          "id": "trust_badge_1_icon",
          "label": "Trust badge 1 icon"
        },
        {
          "type": "text",
          "id": "trust_badge_1_text",
          "label": "Trust badge 1 text",
          "default": "Free shipping"
        },
        {
          "type": "image_picker",
          "id": "trust_badge_2_icon",
          "label": "Trust badge 2 icon"
        },
        {
          "type": "text",
          "id": "trust_badge_2_text",
          "label": "Trust badge 2 text",
          "default": "30-day returns"
        },
        {
          "type": "image_picker",
          "id": "trust_badge_3_icon",
          "label": "Trust badge 3 icon"
        },
        {
          "type": "text",
          "id": "trust_badge_3_text",
          "label": "Trust badge 3 text",
          "default": "Secure checkout"
        }
      ]
    },
    {
      "type": "description",
      "name": "Description",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_description",
          "label": "Show description",
          "default": true
        },
        {
          "type": "range",
          "id": "description_length",
          "label": "Description length (characters)",
          "min": 100,
          "max": 500,
          "step": 50,
          "default": 200
        },
        {
          "type": "checkbox",
          "id": "show_read_more",
          "label": "Show read more button",
          "default": false
        }
      ]
    },
    {
      "type": "collapsible_tab",
      "name": "Collapsible Tab",
      "settings": [
        {
          "type": "text",
          "id": "tab_title",
          "label": "Tab title",
          "default": "Tab title"
        },
        {
          "type": "richtext",
          "id": "tab_content",
          "label": "Tab content"
        }
      ]
    },
    {
      "type": "share_buttons",
      "name": "Share Buttons",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_share_buttons",
          "label": "Show share buttons",
          "default": true
        },
        {
          "type": "text",
          "id": "share_label",
          "label": "Share label",
          "default": "Share"
        },
        {
          "type": "checkbox",
          "id": "show_facebook",
          "label": "Show Facebook",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "show_twitter",
          "label": "Show Twitter",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "show_pinterest",
          "label": "Show Pinterest",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "show_copy_link",
          "label": "Show copy link button",
          "default": true
        }
      ]
    },
    {
      "type": "@app"
    }
  ],
  "presets": [
    {
      "name": "Main Product",
      "blocks": [
        {
          "type": "title"
        },
        {
          "type": "price"
        },
        {
          "type": "variant_picker"
        },
        {
          "type": "quantity_selector"
        },
        {
          "type": "buy_buttons"
        },
        {
          "type": "trust_badges"
        },
        {
          "type": "description"
        },
        {
          "type": "collapsible_tab",
          "settings": {
            "tab_title": "Ingredients",
            "tab_content": "<p>Ingredients content goes here.</p>"
          }
        },
        {
          "type": "collapsible_tab",
          "settings": {
            "tab_title": "Brewing",
            "tab_content": "<p>Brewing instructions go here.</p>"
          }
        },
        {
          "type": "share_buttons"
        }
      ]
    }
  ],
  "default": {
    "blocks": [
      {
        "type": "title"
      },
      {
        "type": "price"
      },
      {
        "type": "variant_picker"
      },
      {
        "type": "quantity_selector"
      },
      {
        "type": "buy_buttons"
      },
      {
        "type": "trust_badges"
      },
      {
        "type": "description"
      },
      {
        "type": "collapsible_tab",
        "settings": {
          "tab_title": "Ingredients",
          "tab_content": "<p>Ingredients content goes here.</p>"
        }
      },
      {
        "type": "collapsible_tab",
        "settings": {
          "tab_title": "Brewing",
          "tab_content": "<p>Brewing instructions go here.</p>"
        }
      },
      {
        "type": "share_buttons"
      }
    ]
  }
}
{% endschema %}
